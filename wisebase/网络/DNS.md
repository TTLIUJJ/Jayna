# DNS域名解析


DNS（Domain Name System）是“域名系统”的英文缩写，它用于TCP/IP网络，它所提供的服务是用来将主机名和域名转换为IP地址的工作。DNS就是这样的一位“翻译官”，它的基本工作原理可用下图来表示。

#### DNS的流程

DNS是应用层协议，事实上它是为其他应用层协议工作的，包括但不限于HTTP、SMTP和FTP，用于将用户提供的主机名解析为IP地址。


- 用户主机上运行着DNS的客户端，就是我们的PC机或者手机客户端运行着DNS客户端
- 浏览器将接收到的URL，取出其中的域名字段，方式访问的主机名，比如：

```sh
http://www.baidu.com
```
将这个主机名传送给DNS应用的客户端

- DNS客户端向DNS服务端发送一份查询报文，报文中的包含着要访问的主机名字段（中间包括一系列缓存查询以及分布式DNS集群的工作）。

- 该DNS客户端最终会收到一份响应报文，其中就包含该主机名对应的IP地址

- 一旦浏览器接收到来自DNS的IP地址，就可向该IP地址定位的HTTP服务器发起TCP连接

#### DNS服务体系架构

假设运行在用户主机上的某些应用程序（如Web浏览器）需要将文件名转换为IP地址。这些应用程序将调用DNS的客户端，并指明需要被转换的主机名（在很多基于Unix的机器上，应用程序使用gethostbyname()来进行这种转换）。 用户主机的DNS客户端接收到后，向网络中发送一个DNS查询报文。所有DNS请求和响应报文使用UDP数据经过端口53发送，若干时间之后，用户主机上的DNS客户端接收到一个关于域名映射IP的DNS响应报文。


#### DNS为什么不采用单点的集中式设计方式，而是使用分布式集群的工作方式？

DNS的一种简单设计模式就是在因特网上只使用一个DNS服务器，该服务器包含所有的映射，在这种集中式的设计中，客户端直接将所有查询请求发往单一的DNS服务器，同时该DNS服务器直接对所有的查询做出响应，但是有如下的缺点：

- 因特网上数量巨大并持续增长的主机，这种集中式设计在DNS服务器单点故障的时候，所有的映射都会失效
- 数不尽的是HTTP请求、电子邮件报文请求使用DNS报文，造成大量通信容量
- 远距离会造成时间延迟大
- 维护开销大，更新一个映射关系都必须在那个单一的DNS服务器进行处理

**分布式集群的工作方式**

DNS服务器一般分为三种：

- 根DNS服务器
- 顶级DNS服务器
- 权威DNS服务器

使用分布式的层次数据库模式，以及缓存方法来解决单点集中式的问题